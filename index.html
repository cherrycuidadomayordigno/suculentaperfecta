<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>¿Qué suculenta necesitas?</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --main-bg: #f5f8f6;
      --main-color: #222a26;
      --accent: #8bc34a;
      --soft: #fff;
      --border: #e2e6ea;
      --shadow: 0 2px 24px 0 #9bcfbc24;
      --radius: 22px;
      --transition: 0.18s cubic-bezier(.4,0,.2,1);
    }
    html, body {
      background: var(--main-bg);
      color: var(--main-color);
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    h1 {
      text-align: center;
      font-size: 2.5em;
      font-weight: 800;
      letter-spacing: 0.5px;
      margin-top: 38px;
      margin-bottom: 10px;
    }
    .main-flex {
      display: flex;
      justify-content: center;
      align-items: stretch;
      gap: 0;
      max-width: 950px;
      margin: 0 auto 40px auto;
      padding: 0 3vw;
      position: relative;
    }
    .side-gallery {
      width: 180px;
      min-width: 100px;
      background: none;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      margin: 0;
      user-select: none;
      position: relative;
      z-index: 1;
      animation: floatin 0.8s;
    }
    @keyframes floatin {
      from { opacity:0; transform:translateY(20px);}
      to { opacity:1; transform:translateY(0);}
    }
    .side-gallery .plant-img-frame {
      width: 100%;
      aspect-ratio: 1/1;
      margin-bottom: 0;
      position: relative;
      overflow: visible;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      border-radius: 20px;
      cursor: pointer;
    }
    .side-gallery img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 20px;
      box-shadow: 0 7px 30px #8bc34a26, 0 2px 9px #bbb2;
      background: #e0e9e2;
      filter: grayscale(0.1);
      transition: box-shadow .23s, filter .21s, transform .16s;
      will-change: filter, box-shadow, transform;
    }
    .side-gallery img.active {
      filter: brightness(1.13) saturate(1.13) drop-shadow(0 0 16px #8bc34a22) grayscale(0);
      box-shadow: 0 18px 70px #8bc34a3d, 0 1px 11px #7bc34a36;
      transform: scale(1.055);
      z-index: 2;
    }
    .plant-caption {
      margin-top: 11px;
      margin-bottom: 6px;
      background: rgba(255,255,255,0.97);
      box-shadow: 0 2px 13px #7bc34a14;
      border-radius: 11px;
      padding: 8px 8px 7px 8px;
      text-align: center;
      min-width: 0;
      max-width: 175px;
      font-size: 1.02em;
      color: #426c38;
      font-weight: 600;
      opacity: 0.88;
      user-select: text;
      pointer-events:none;
      transition: opacity .13s;
    }
    .plant-caption .e {
      color: #7bbf2c;
      font-size: 0.93em;
      font-weight: 700;
      letter-spacing: 0.01em;
      opacity: 0.82;
    }
    .plant-caption .s {
      color: #596f5a;
      font-size: 0.96em;
      font-weight: 400;
      opacity: 0.70;
      display: block;
      margin-top: 1px;
    }
    .side-gallery .arrow-btn {
      background: #fff;
      border: 1.5px solid #d4efb2;
      color: #8bc34a;
      border-radius: 50%;
      font-size: 1.65em;
      width: 38px;
      height: 38px;
      margin: 11px 0 0 0;
      box-shadow: 0 2px 12px #8bc34a19;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background .14s, color .13s, border .13s;
      outline: none;
      z-index: 2;
      user-select: none;
    }
    .side-gallery .arrow-btn:hover,
    .side-gallery .arrow-btn:focus-visible {
      background: #8bc34a;
      color: #fff;
      border-color: #8bc34a;
    }
    main.form-zone {
      background: var(--soft);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 34px 32px 18px 32px;
      border: 1.5px solid var(--border);
      margin-bottom: 38px;
      min-width: 320px;
      max-width: 440px;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      z-index: 2;
      animation: floatin .3s;
    }
    main.form-zone:hover {
      box-shadow: 0 12px 42px #98d58732;
    }
    form label {
      display: block;
      margin: 23px 0 6px 0;
      font-weight: 600;
      font-size: 1.08em;
    }
    form select,
    form button {
      width: 100%;
      font-size: 1.07em;
      padding: 13px 11px;
      border-radius: 10px;
      border: 1.5px solid var(--border);
      margin-bottom: 0;
      background: #fff;
      transition: border-color var(--transition), box-shadow var(--transition);
    }
    form select:focus {
      border-color: var(--accent);
      box-shadow: 0 2px 8px #8bc34a22;
      outline: none;
    }
    form button {
      margin-top: 22px;
      background: linear-gradient(90deg, #8bc34a 60%, #d4fc79 100%);
      color: #233;
      font-weight: 800;
      letter-spacing: 0.7px;
      border: none;
      cursor: pointer;
      box-shadow: 0 2px 12px #8bc34a33;
      text-transform: uppercase;
      border-bottom: 3px solid #6ea03c;
      transition: transform 0.09s, background var(--transition);
    }
    form button:hover, form button:focus {
      background: linear-gradient(90deg, #b7e46a 10%, #8bc34a 95%);
      transform: scale(1.025);
      border-bottom: 3px solid #b7e46a;
    }
    #resultado {
      margin: 45px auto 40px auto;
      max-width: 700px;
      border-radius: var(--radius);
      box-shadow: 0 6px 35px #8bc34a12;
      padding: 0;
      display: none;
      border: none;
      background: none;
      z-index: 3;
      position: relative;
    }
    #resultado .big-img-plant {
      display: block;
      margin: 0 auto 24px auto;
      max-width: 410px;
      max-height: 330px;
      width: 99vw;
      height: auto;
      box-shadow: 0 4px 38px #b7d6bc3c;
      border-radius: 25px;
      background: #e0e9e2;
      transition: box-shadow var(--transition), transform var(--transition);
      object-fit: cover;
    }
    #resultado .big-img-plant:hover {
      box-shadow: 0 10px 50px #b7d6bc55;
      transform: scale(1.05);
    }
    #resultado h2 {
      text-align: center;
      color: #8bc34a;
      font-weight: 800;
      font-size: 2em;
      margin-top: 0;
      letter-spacing: 0.2px;
      margin-bottom: 0.9em;
    }
    .respuestas {
      margin: 0 auto; max-width: 440px; text-align: center;
      font-size: 1.09em;
      color: #42743d;
    }
    .respuestas ul {
      padding-left: 0;
      margin: 0;
      list-style: none;
      line-height: 1.6;
    }
    .respuestas li {
      margin-bottom: 4px;
      font-size: 1em;
      border-bottom: 1px dotted #e3e3e3;
      padding-bottom: 4px;
    }
    .conclusion {
      margin: 38px auto 0 auto;
      padding: 30px 12vw 30px 12vw;
      background: #fff;
      border-radius: 25px;
      font-size: 1.13em;
      color: #594e2d;
      line-height: 1.62;
      box-shadow: 0 1px 9px #e2e2c241;
      max-width: 650px;
    }
    /* Responsive */
    @media (max-width: 900px) {
      .main-flex {
        flex-direction: column;
        align-items: center;
        max-width: 99vw;
      }
      .side-gallery {
        flex-direction: row;
        width: 100%;
        max-width: 99vw;
        justify-content: center;
        margin: 0 0 17px 0;
        gap: 18px;
      }
      .side-gallery .plant-img-frame {
        width: 95px;
        min-width: 75px;
        max-width: 130px;
      }
      .plant-caption { max-width: 110px; font-size: 0.97em;}
    }
    @media (max-width: 600px) {
      h1 { font-size: 1.45em; }
      .main-flex { padding: 0; }
      main.form-zone { padding: 10px 2vw 8px 2vw; min-width: 0; max-width: 99vw; }
      .side-gallery .plant-img-frame {
        width: 71px;
        min-width: 59px;
      }
      .plant-caption { padding: 6px 4px 5px 7px; font-size: 0.93em;}
    }
  </style>
</head>
<body>
  <h1>¿Qué suculenta necesitas?</h1>
  <div class="main-flex">
    <div class="side-gallery" id="side-gallery-left">
      <!-- Fotos izquierda -->
    </div>
    <main class="form-zone">
      <form id="form-suculenta" autocomplete="off">
        <label for="signo">¿Cuál es tu signo zodiacal?</label>
        <select id="signo" name="signo" required>
          <option value="">Selecciona tu signo</option>
          <option>Aries</option>
          <option>Tauro</option>
          <option>Géminis</option>
          <option>Cáncer</option>
          <option>Leo</option>
          <option>Virgo</option>
          <option>Libra</option>
          <option>Escorpio</option>
          <option>Sagitario</option>
          <option>Capricornio</option>
          <option>Acuario</option>
          <option>Piscis</option>
        </select>
        <label for="vida">¿Qué aspecto de tu vida te gustaría potenciar o equilibrar?</label>
        <select id="vida" name="vida" required>
          <option value="">Selecciona una opción</option>
          <option>Amor</option>
          <option>Salud</option>
          <option>Dinero</option>
          <option>Familia</option>
          <option>Trabajo</option>
          <option>Creatividad</option>
          <option>Equilibrio emocional</option>
          <option>Crecimiento espiritual</option>
          <option>Otro</option>
        </select>
        <label for="elemento">¿Con qué elemento te identificas más?</label>
        <select id="elemento" name="elemento" required>
          <option value="">Selecciona un elemento</option>
          <option>Fuego</option>
          <option>Tierra</option>
          <option>Aire</option>
          <option>Agua</option>
        </select>
        <label for="buscas">¿Qué buscas en una planta?</label>
        <select id="buscas" name="buscas" required>
          <option value="">Selecciona una opción</option>
          <option>Facilidad de cuidado</option>
          <option>Floración</option>
          <option>Color</option>
          <option>Resistencia</option>
          <option>Forma</option>
          <option>Propiedades energéticas</option>
          <option>Otra</option>
        </select>
        <label for="color">¿Qué color te atrae más?</label>
        <select id="color" name="color" required>
          <option value="">Selecciona un color</option>
          <option>Verde</option>
          <option>Rojo</option>
          <option>Naranja</option>
          <option>Amarillo</option>
          <option>Rosa</option>
          <option>Violeta</option>
          <option>Azul</option>
          <option>Blanco</option>
          <option>Gris</option>
          <option>Multicolor</option>
        </select>
        <label for="nivel">¿Prefieres trabajar tu energía a nivel…?</label>
        <select id="nivel" name="nivel" required>
          <option value="">Selecciona un nivel</option>
          <option>Físico</option>
          <option>Mental</option>
          <option>Emocional</option>
          <option>Espiritual</option>
          <option>Todos</option>
        </select>
        <button type="submit" id="submit-btn">
          🌈✨ Ver mi lectura personalizada ✨🌱
        </button>
      </form>
    </main>
    <div class="side-gallery" id="side-gallery-right">
      <!-- Fotos derecha -->
    </div>
  </div>
  <div id="resultado"></div>
  <script>
    // Plantas con minidescripción corta
    const plantas = [
      { key:"el_cactus_cacahuete", nombre: "El Cactus Cacahuete", archivo: "cactus-cacahuete", energia: "alegría, renovación, vitalidad", short: "Cactus amigable, tallos finos y flores naranjas intensas." },
      { key:"graptosedum_california_sunset", nombre: "Graptosedum 'California Sunset'", archivo: "graptosedum", energia: "transformación, flexibilidad, belleza interior y exterior", short: "Rosetas que cambian de verde a naranja y rosa con el sol." },
      { key:"ojo_de_dragon", nombre: "Ojo de Dragón", archivo: "huerniaojodedragon", energia: "protección, intuición, percepción", short: "Flores exóticas y forma compacta; ideal para colección." },
      { key:"callisia_navicularis", nombre: "Callisia Navicularis", archivo: "callisianavicularis", energia: "resiliencia, protección, equilibrio", short: "Hojas gruesas, verdes y púrpuras, de crecimiento rastrero." },
      { key:"cactus_coral", nombre: "\"Cactus Coral\" o \"Cactus Arroz\"", archivo: "cactuscoral-2", energia: "adaptabilidad, conexión, ligereza", short: "Tallos en forma de coral, colgante y muy resistente." },
      { key:"madreperla", nombre: "Madreperla", archivo: "madreperla-2", energia: "belleza interior, protección, suavidad", short: "Hojas gris-verde con tonos rosados, ideal para macetas colgantes." },
      { key:"mammillaria_vetula", nombre: "Mammillaria vetula", archivo: "mammillariavetula", energia: "protección, suavidad, crecimiento interior", short: "Cactus pequeño, peludo y fácil de cuidar." },
      { key:"mammillaria_prolifera", nombre: "Mammillaria prolifera", archivo: "mammillariaprolifera", energia: "abundancia, multiplicidad, comunidad", short: "Forma grupos de bolitas; florece y crece en racimos." },
      { key:"echeveria_elegans", nombre: "Echeveria elegans", archivo: "echeveria-elegans-2", energia: "armonía, belleza, perfección", short: "Roseta simétrica azulada, resistente y ornamental." },
      { key:"crassula_expansa_subsp_fragilis", nombre: "Crassula expansa subsp. fragilis", archivo: "crassulafragilis", energia: "delicadeza, adaptación, flexibilidad", short: "Tallos finos y flexibles, hojas pequeñas y delicadas." },
      { key:"opuntia_monacantha_fma_variegada_monstruosa", nombre: "Opuntia monacantha fma. variegada monstruosa", archivo: "monstruosa", energia: "originalidad, fortaleza, sanación", short: "Opuntia de formas únicas, variegada y llamativa." }
    ];

    // Side galleries: 3 plantas por cada lado, rotación independiente
    let leftIndexes = [0, 1, 2], rightIndexes = [3, 4, 5];
    function buscarImagen(nombreBase, callback) {
      const exts = ["jpg", "jpeg", "png"];
      let idx = 0;
      function probar() {
        if (idx >= exts.length) {
          callback("fotos/no-disponible.png");
          return;
        }
        const ruta = `fotos/${nombreBase}.${exts[idx]}`;
        const img = new window.Image();
        img.onload = () => callback(ruta);
        img.onerror = () => { idx++; probar(); };
        img.src = ruta;
      }
      probar();
    }
    function renderGallery(containerId, indexes, isLeft) {
      const cont = document.getElementById(containerId);
      cont.innerHTML = '';
      indexes.forEach((idx, n) => {
        const val = plantas[idx];
        const frame = document.createElement('div');
        frame.className = 'plant-img-frame';
        buscarImagen(val.archivo, (ruta) => {
          frame.innerHTML = `
            <img src="${ruta}" alt="${val.nombre}" class="${n === 1 ? 'active' : ''}">
          `;
        });
        // Caption solo para la central
        if (n === 1) {
          const caption = document.createElement('div');
          caption.className = 'plant-caption';
          caption.innerHTML = `<span>${val.nombre}</span>
            <span class="e">${val.energia}</span>
            <span class="s">${val.short}</span>`;
          frame.appendChild(caption);
        }
        cont.appendChild(frame);
      });
      // Flechas
      const arrowPrev = document.createElement('button');
      arrowPrev.className = 'arrow-btn';
      arrowPrev.innerHTML = isLeft ? '⟲' : '⟳';
      arrowPrev.title = isLeft ? "Rotar arriba" : "Rotar abajo";
      arrowPrev.onclick = function(){
        rotateGallery(isLeft, -1);
      };
      cont.appendChild(arrowPrev);

      const arrowNext = document.createElement('button');
      arrowNext.className = 'arrow-btn';
      arrowNext.innerHTML = isLeft ? '⟳' : '⟲';
      arrowNext.title = isLeft ? "Rotar abajo" : "Rotar arriba";
      arrowNext.onclick = function(){
        rotateGallery(isLeft, 1);
      };
      cont.appendChild(arrowNext);
    }
    function rotateGallery(isLeft, dir) {
      if (isLeft) {
        if (dir > 0) leftIndexes = leftIndexes.slice(1).concat([getNextFreeIndex(leftIndexes)]);
        else leftIndexes = [getNextFreeIndex(leftIndexes)].concat(leftIndexes.slice(0,2));
        renderGallery('side-gallery-left', leftIndexes, true);
      } else {
        if (dir > 0) rightIndexes = rightIndexes.slice(1).concat([getNextFreeIndex(rightIndexes)]);
        else rightIndexes = [getNextFreeIndex(rightIndexes)].concat(rightIndexes.slice(0,2));
        renderGallery('side-gallery-right', rightIndexes, false);
      }
    }
    function getNextFreeIndex(current) {
      // get a plant index not shown currently in either gallery, or just next in list
      let used = [...leftIndexes, ...rightIndexes];
      for (let i=0;i<plantas.length;i++) if (!used.includes(i)) return i;
      // fallback: rotate through all indexes
      return (Math.max(...current)+1)%plantas.length;
    }
    // Inicialización
    renderGallery('side-gallery-left', leftIndexes, true);
    renderGallery('side-gallery-right', rightIndexes, false);

    // -------- FORMULARIO PERSONALIZADO --------
    const signosElementos = {
      Aries: "Fuego", Leo: "Fuego", Sagitario: "Fuego",
      Tauro: "Tierra", Virgo: "Tierra", Capricornio: "Tierra",
      Géminis: "Aire", Libra: "Aire", Acuario: "Aire",
      Cáncer: "Agua", Escorpio: "Agua", Piscis: "Agua"
    };
    function sugerirPlanta(respuestas) {
      const color = respuestas[4].valor?.toLowerCase();
      for (let i=0; i<plantas.length; i++) {
        if (plantas[i].energia.toLowerCase().includes(color)) return i;
        if (plantas[i].nombre.toLowerCase().includes(color)) return i;
      }
      return Math.floor(Math.random() * plantas.length);
    }
    function articuloAspecto(aspecto) {
      const femeninos = [
        "Salud", "Familia", "Creatividad", "Abundancia", "Armonía", "Estabilidad",
        "Protección", "Suavidad", "Belleza", "Resiliencia", "Comunidad",
        "Floración", "Forma", "Energía", "Paz interior", "Ternura",
        "Percepción", "Intuición", "Autoafirmación"
      ];
      if (aspecto === "Equilibrio emocional" || aspecto === "Crecimiento espiritual") return "el";
      if (femeninos.includes(aspecto)) return "la";
      if (aspecto === "Dinero" || aspecto === "Trabajo" || aspecto === "Amor") return "el";
      return "el";
    }
    function mensajeSorpresa(signo, aspecto, elemento, nivel, color) {
      const secretosPorSigno = {
        Aries: "En tu interior arde la chispa del primer aliento de la creación, y tu energía es capaz de abrir caminos donde nada existía.",
        Tauro: "Tu perseverancia es raíz y fruto. Lo que siembras en tu vida florece con paciencia, y tu corazón busca la belleza oculta en lo simple.",
        Géminis: "Tu palabra es puente entre mundos. Como el viento, llevas mensajes y siembras ideas; tu misión es conectar lo disperso.",
        Cáncer: "En tus emociones reside la memoria del alma colectiva. Eres el guardián de la ternura y la intuición profunda.",
        Leo: "Tu luz es reflejo de la fuente primordial. Cuando brillas, inspiras a otros a descubrir su propio sol.",
        Virgo: "La perfección que buscás es el reflejo de un orden profundo. Tu capacidad de servicio sana y purifica tu entorno.",
        Libra: "Tu alma anhela el equilibrio del universo. Allí donde intervenís, la armonía se vuelve posible.",
        Escorpio: "Portás el secreto de la transformación. En vos, lo oculto se revela y la sombra se convierte en poder.",
        Sagitario: "Tu mirada trasciende horizontes. Sos portador de la verdad y la expansión, flecha que apunta al sentido.",
        Capricornio: "Tu disciplina es puente entre el cielo y la tierra. Sos arquitecto de realidades y guardián de la perseverancia.",
        Acuario: "Sos canal de la nueva visión. Tu originalidad siembra futuro y tu mente es manantial de libertad.",
        Piscis: "En tu sensibilidad habita la compasión universal. Donde otros ven caos, vos percibís la unidad de todas las almas."
      };
      const secretosPorAspecto = {
        Amor: "El amor es la energía que sostiene la existencia. Cuando lo invocás, el universo conspira a tu favor.",
        Salud: "La salud proviene del equilibrio interno. Si honrás tu cuerpo, el espíritu florece.",
        Dinero: "La prosperidad es el reflejo de la confianza en recibir. Abre tu mano y la abundancia fluirá.",
        Familia: "La familia es el primer círculo sagrado. Allí se revela la enseñanza del dar y el recibir.",
        Trabajo: "Tu labor es el altar donde tu alma se expresa. Cada acción consciente te acerca a tu propósito.",
        Creatividad: "La creatividad es la chispa divina en acción. Cuando creás, te conectás con la fuente primordial.",
        "Equilibrio emocional": "El equilibrio emocional es la llave para que la energía fluya sin bloqueos. Si te escuchás, tu corazón se vuelve brújula.",
        "Crecimiento espiritual": "El crecimiento espiritual es el viaje del alma hacia la luz. Cada paso interior es un retorno a tu origen.",
        Otro: "Aquello que buscás, ya está en tu interior. La respuesta se revela cuando te permitís recibir."
      };
      const mensajeColor = {
        Verde: "El verde renueva y sana, trayendo esperanza y expansión.",
        Rojo: "El rojo despierta la pasión y da fuerza vital.",
        Naranja: "El naranja enciende la creatividad y la alegría.",
        Amarillo: "El amarillo ilumina la mente y atrae claridad.",
        Rosa: "El rosa activa la ternura y el amor incondicional.",
        Violeta: "El violeta transmuta y libera, abriendo el camino a la transformación.",
        Azul: "El azul calma y conecta con la intuición profunda.",
        Blanco: "El blanco purifica y expande la conciencia.",
        Gris: "El gris equilibra las polaridades y aporta neutralidad.",
        Multicolor: "La mezcla de colores simboliza la integración de todos los caminos."
      };
      const mensajeNivel = {
        Físico: "Esta energía te ayudará a enraizar tu cuerpo.",
        Mental: "Favorecerá la claridad de pensamiento.",
        Emocional: "Te acompañará en el reconocimiento de tus emociones.",
        Espiritual: "Es un canal para elevar tu conciencia.",
        Todos: "Trabajará en todos los planos, favoreciendo la integración total."
      };
      return `<b>Sorpresa:</b> ${secretosPorSigno[signo] || ""}<br>
      <b>Clave para tu vida:</b> ${secretosPorAspecto[aspecto] || ""}<br>
      <b>Vibración del color:</b> ${mensajeColor[color] || ""}<br>
      <b>Nivel energético:</b> ${mensajeNivel[nivel] || ""}`;
    }
    function generarConclusion(respuestas, info) {
      const signo = respuestas[0].valor;
      const aspecto = respuestas[1].valor;
      const elemento = respuestas[2].valor;
      const buscas = respuestas[3].valor;
      const color = respuestas[4].valor;
      const nivel = respuestas[5].valor;
      const elementoZ = signosElementos[signo];
      const elementoPreferido = elemento;
      let articulo = articuloAspecto(aspecto);

      let conclusion = `<b>Lectura personalizada:</b><br><br>`;
      conclusion += `La <b>${info.nombre}</b> es una planta asociada con la energía de ${info.energia}. `;
      conclusion += `Tu signo es <b>${signo}</b> (${elementoZ}), lo que genera una interacción muy especial entre tu naturaleza y la vibración de esta suculenta, especialmente en lo relacionado con ${articulo} ${aspecto.toLowerCase()}. `;
      if (elementoZ === elementoPreferido) {
        conclusion += `Esta afinidad elemental fortalece la sintonía natural, facilitando el equilibrio y la integración de tu energía. `;
      } else {
        conclusion += `Aunque tu signo pertenece al elemento ${elementoZ.toLowerCase()}, tu inclinación hacia ${elementoPreferido.toLowerCase()} indica una búsqueda de balance complementario. `;
      }
      conclusion += `<br><br>El hecho de que busques ${buscas.toLowerCase()} y te atraiga el color ${color.toLowerCase()} sugiere que tu campo personal está receptivo a la vibración específica de esta suculenta. El color elegido actúa como resonador, amplificando el efecto transformador y sanador de la planta sobre tu energía. `;
      conclusion += `<br><br><b>En síntesis:</b> la <b>${info.nombre}</b> puede ayudarte a equilibrar y potenciar tu energía, actuando como un puente entre tu búsqueda interna y las fuerzas universales. Si la cuidás y te conectás con su presencia, contribuirá a tu proceso de sanación y expansión personal.<br>`;
      conclusion += `<br>Recuerda: cada planta puede ser un canal de luz y conciencia. Toda elección consciente es un paso hacia tu plenitud.<br><br>`;
      conclusion += `<div style="margin-top:14px">${mensajeSorpresa(signo, aspecto, elemento, nivel, color)}</div>`;
      return conclusion;
    }
    function validarEmail(email) {
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.trim());
    }
    document.getElementById('form-suculenta').addEventListener('submit', function(e) {
      e.preventDefault();
      const fd = new FormData(this);
      const respuestas = [
        { titulo: "Signo zodiacal", valor: fd.get('signo') },
        { titulo: "Aspecto de la vida que te gustaría potenciar o equilibrar", valor: fd.get('vida') },
        { titulo: "Elemento con el que te identificás más", valor: fd.get('elemento') },
        { titulo: "¿Qué buscas en una planta?", valor: fd.get('buscas') },
        { titulo: "Color que más te atrae", valor: fd.get('color') },
        { titulo: "Nivel para trabajar tu energía", valor: fd.get('nivel') }
      ];
      // Sugerir planta
      const idxSug = sugerirPlanta(respuestas);
      const info = plantas[idxSug];
      buscarImagen(info.archivo, (rutaImagen) => {
        const cont = document.getElementById('resultado');
        const conclusion = generarConclusion(respuestas, info);
        cont.innerHTML = `
          <h2>Tu lectura personalizada</h2>
          <img src="${rutaImagen}" alt="${info.nombre}" class="big-img-plant">
          <div class="respuestas">
            <h3>Tus respuestas:</h3>
            <ul>
              ${respuestas.map(r => `<li><b>${r.titulo}:</b> ${r.valor}</li>`).join('')}
            </ul>
          </div>
          <div class="conclusion">
            ${conclusion}
          </div>
          <form id="mail-form" style="display:flex;align-items:center;gap:10px;margin-top:32px;flex-wrap:wrap;">
            <input id="mail-to" type="email" name="email" placeholder="Escribí tu e-mail" style="flex:1 1 220px;font-size:1.08em;padding:10px 14px;border-radius:7px;border:1.5px solid #cfe5d3;outline:none;background:#f8f9fa;" required>
            <button id="send-mail-btn" title="Enviar por email" type="submit" style="background:linear-gradient(90deg,#69b47c 60%,#ffb3b3 100%);border:none;border-radius:50%;padding:10px;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 10px #e1b7b73d;" disabled>
              <svg viewBox="0 0 24 24" width="26" height="26" style="vertical-align:middle;" fill="#fff"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
            </button>
          </form>
          <div id="mail-confirm" style="margin-top:10px;color:#3080b4;font-size:1.06em;font-weight:500;"></div>
        `;
        cont.style.display = 'block';
        cont.scrollIntoView({behavior: 'smooth'});
        // --- Formspree AJAX ---
        const mailInput = document.getElementById('mail-to');
        const sendBtn = document.getElementById('send-mail-btn');
        const mailForm = document.getElementById('mail-form');
        const mailConfirm = document.getElementById('mail-confirm');
        function updateBtnState() {
          if (validarEmail(mailInput.value)) {
            sendBtn.disabled = false;
            mailInput.style.borderColor = "#69b47c";
          } else {
            sendBtn.disabled = true;
            mailInput.style.borderColor = "#fbb3b3";
          }
          mailConfirm.textContent = "";
        }
        mailInput.addEventListener('input', updateBtnState);
        mailForm.onsubmit = function(ev) {
          ev.preventDefault();
          const to = mailInput.value.trim();
          if (!validarEmail(to)) {
            mailInput.style.borderColor = "#fbb3b3";
            mailConfirm.textContent = "Por favor, escribí un e-mail válido.";
            return;
          }
          sendBtn.disabled = true;
          mailConfirm.style.color = "#3080b4";
          mailConfirm.textContent = "Enviando...";
          const textRespuestas = respuestas.map(r => `${r.titulo}: ${r.valor}`).join("\n");
          const conclusionText = conclusion.replace(/<[^>]+>/g, '').replace(/\s+\n/g, '\n');
          const mensaje =
            `Resultado de mi lectura personalizada:\n\n` +
            `Planta sugerida: ${info.nombre}\n${info.short}\n\n` +
            `Mis respuestas:\n${textRespuestas}\n\n` +
            `Lectura:\n${conclusionText}\n\n¡Gracias!`;
          fetch("https://formspree.io/f/meokgbvo", {
            method: "POST",
            headers: { "Accept": "application/json", "Content-Type": "application/json" },
            body: JSON.stringify({ email: to, message: mensaje })
          })
          .then(response => response.json())
          .then(data => {
            if(data.ok || data.success || data["next"]){
              mailConfirm.style.color = "#2e8c57";
              mailConfirm.textContent = "¡Enviado! Revisá tu correo 😊";
              mailInput.value = "";
            } else {
              mailConfirm.style.color = "#e04b4b";
              mailConfirm.textContent = "Ocurrió un error. Intentá de nuevo más tarde.";
            }
          }).catch(() => {
            mailConfirm.style.color = "#e04b4b";
            mailConfirm.textContent = "Ocurrió un error. Intentá de nuevo más tarde.";
          }).finally(()=>{sendBtn.disabled=false;});
        };
        sendBtn.disabled = true;
      });
    });
  </script>
</body>
</html>